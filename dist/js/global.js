$(".search-bar-container input").focus(),window.innerWidth>1080&&$(".menu-item--top-level .sub-menu--level-one > li:nth-child(2)").addClass("active").find(".sub-menu--level-two").addClass("accordian-open");var pagePath=window.location.pathname,heroImg="url(/v/vspfiles/templates/gfp-test/img/hero--generic-"+getRandomInt(1,5)+".jpg)",heroText="Green Farm Parts",breadcrumbs=document.querySelector(".matching_results_text");if(breadcrumbs){var breadcrumbArray=breadcrumbs.previousElementSibling.textContent.split(">");heroText=breadcrumbArray[breadcrumbArray.length-1]}if(pagePath.match(/Filters/i)&&(heroImg="url(/v/vspfiles/templates/gfp-test/img/hero--filters.jpg)"),pagePath.match(/Maintenance-Kits/i)&&(heroImg="url(/v/vspfiles/templates/gfp-test/img/hero--maintenance-kits.jpg)"),pagePath.match(/Toys/i)&&(heroImg="url(/v/vspfiles/templates/gfp-test/img/hero--toys.jpg)"),"/searchresults.asp"===pagePath){function filterItems(e){return searchStringArray.filter(function(t){return t.toLowerCase().indexOf(e.toLowerCase())>-1})}searchString=window.location.search,searchStringArray=searchString.split("&");var searchStringTerm=filterItems("search=").toString().split("=")[1];heroText="Search for: "+(searchStringTerm=searchStringTerm.split("+").join(" "))}if("/ShoppingCart.asp"===pagePath||"/shoppingcart.asp"===pagePath){heroText="Shopping Cart";var itemDescription=document.querySelector("#v65-cart-header-itemdescription font");if(null!=itemDescription){var itemDescriptionArray=itemDescription.innerHTML.split("&nbsp;");itemDescription.innerHTML=itemDescriptionArray[0]+" "+itemDescriptionArray[2]}var emptyCartRow=$(".v65-cart-shipping-details-row").children().first();emptyCartRow.length<0&&(emptyCartRow.siblings().remove(),emptyCartRow[0].colSpan=12)}if("/myaccount.asp"===pagePath&&(heroText="My Account Details"),"/login.asp"===pagePath&&(heroText="Login"),"/terms.asp"===pagePath&&(heroText="Terms and Conditions"),"/one-page-checkout.asp"===pagePath){heroText="Checkout";var billInputs=["v65-onepage-billfirstname","v65-onepage-billlastname","v65-onepage-billcompanyname","v65-onepage-billaddr1","v65-onepage-billaddr2","v65-onepage-billcity","v65-onepage-billpostalcode","v65-onepage-billphone","v65-onepage-billfax","v65-cart-billemail"];document.addEventListener("keyup",function(e){if(billInputs.includes(e.target.id)){var t=e.target;matchCheckoutInput(t,t.value)}})}"/"!=pagePath&&updateHero(heroImg,heroText),breadcrumbs&&breadcrumbs.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.classList.add("breadcrumbs");var siteHeader=document.querySelector(".site-header"),siteHeaderOffset=siteHeader.offsetTop;if(siteHeader&&window.addEventListener("scroll",fixHeader),document.addEventListener("click",function(e){("hamburger"===e.target.id||e.target.classList.contains("hamburger-box")||e.target.classList.contains("hamburger-inner"))&&toggleMenu(),e.target.classList.contains("accordian-toggle--site-header")&&toggleMenuAccordian(e),"#chat"===e.target.hash&&toggleChatWindow(e)}),"/ShoppingCart.asp"===pagePath||"/shoppingcart.asp"===pagePath){var reCalcButton=$("#btnRecalculate");$("#v65-cart-shipping-details-wrapper").remove();for(var shoppingCartForm=$("#v65-cart-table").parent("form"),cartRows=document.querySelectorAll("#v65-cart-table .v65-cart-details-row"),cleanCartRows=[],i=0;i<cartRows.length;i++){var removeLink=cartRows[i].querySelector(".v65-cart-item-remove-link"),productImage=cartRows[i].querySelector(".v65-cart-detail-productimage").innerHTML,productName=cartRows[i].querySelector(".v65-cart-details-text .cart-item-name"),quantityInput=cartRows[i].querySelector('input[name*="Quantity"]'),productPrice=cartRows[i].querySelector("td:nth-child(9) .carttext").innerText,sumPrice=cartRows[i].querySelector("td:nth-child(11) .carttext").innerText;cleanCartRows.push({removeLink:removeLink,productImage:productImage,productName:productName,quantityInput:quantityInput,productPrice:productPrice,sumPrice:sumPrice})}shoppingCartForm.prepend('<div id="gfp-responsive-cart"><table><thead><tr><th class="gfp-responsive-cart--product-image"></th><th class="gfp-responsive-cart--product-description">Item</th><th class="gfp-responsive-cart--unit-price">Unit Price</th><th class="gfp-responsive-cart--quantity">Quantity</th><th class="gfp-responsive-cart--unit-total">Total</th><th class="gfp-responsive-cart--remove-item"></th></tr></thead><tbody></tbody></table>'+reCalcButton[0].outerHTML+"</div>"),$("#v65-cart-table").remove();for(i=0;i<cleanCartRows.length;i++){var cartTable=$("#gfp-responsive-cart tbody");cartTable.append('<tr><td class="gfp-responsive-cart--product-image">'+cleanCartRows[i].productImage+'</td><td class="gfp-responsive-cart--product-description">'+cleanCartRows[i].productName.innerText+'</td><td class="gfp-responsive-cart--unit-price">'+cleanCartRows[i].productPrice+'</td><td class="gfp-responsive-cart--quantity">'+cleanCartRows[i].quantityInput.outerHTML+'</td><td class="gfp-responsive-cart--unit-total">'+cleanCartRows[i].sumPrice+'</td><td class="gfp-responsive-cart--remove-item">'+cleanCartRows[i].removeLink.outerHTML+"</td></tr>")}}var checkoutContainer=$("#v65-onepage-Detail"),billingHeader=$("#billing-header").html(),billingContent=$("#v65-onepage-BillingParent").html(),shippingHeader=$("#shipping-header").html(),shippingContent=$("#v65-onepage-ShippingParent").html(),additionalInfoHeader=$(".v65-onepage-custom-header-row").html(),additionalInfoContent=$(".v65-onepage-custom-details-row").html(),shippingCostHeader=$("#v65-onepage-ShippingCostHeader").html(),shippingCostContent=$("#v65-onepage-ShippingCostTotals").html(),shippingTotals=$("#v65-onepage-ShippingCostParent").parent().html();checkoutContainer.remove(),$("#FormatListofErrorsDiv").after('<div id="gfp-responsive-checkout"></div>');var respCheckout=$("#gfp-responsive-checkout");if(respCheckout.html('<div class="gfp-half"><div>'+billingHeader+billingContent+"</div><div>"+shippingHeader+shippingContent+"</div></div>"),respCheckout.append('<table id="v65-onepage-additional-info"><tbody><tr>'+additionalInfoHeader+"</tr><tr>"+additionalInfoContent+"</tr></tbody></table>"),respCheckout.append(shippingTotals),$('img[src="/v/vspfiles/templates/gfp-test/images/clear1x1.gif"]').remove(),$('.colors_pricebox img[src="/v/vspfiles/templates/gfp-test/images/PBox_Border_Left_Top.gif"]').parent("tr").remove(),$("#v65-onepage-breadcrumb")&&$("#v65-onepage-breadcrumb").remove(),$("#v65-onepage-CopyBillingToShippingLink").remove(),window.global_Current_ProductCode){var pageTitle=$(".vp-product-title")[0].innerText,productDescriptionWrap=$("#v65-productdetail-action-wrapper");productDescriptionWrap.css("display","block").attr("align","left"),productDescriptionWrap.siblings().css("display","block"),updateHero(heroImg,pageTitle);var relatedProductsContainer=$("#v65-product-parent").next().find(".colors_lines_light").first();"v65-product-related"!==relatedProductsContainer[0].id&&getRelatedProducts(),$('span[itemprop="description"]').prepend('<p class="h1">'+pageTitle+"</p>");var fitmentString=$("#ProductDetail_ProductDetails_div2 li");if(fitmentString.length>0){var fitmentArray=fitmentString[0].innerText.split("|").sort();$("#ProductDetail_ProductDetails_div2").remove(),$("#v65-product-parent > tbody > tr:nth-child(2) > td:nth-child(2) > table > tbody > tr > td > table > tbody").append('<tr><td colspan="2"><h3 class="mar-t--more">'+pageTitle+' fits the following models:</h3><hr><ul id="gfp-fitment"></ul></tr></td>');var fitmentList=$("#gfp-fitment");for(i=0;i<fitmentArray.length;i++)fitmentList.append("<li>"+fitmentArray[i]+"</li>")}$("#related_products_content").length>0&&formatRelatedProducts()}function getRandomInt(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function toggleMenu(){document.body.classList.toggle("menu-open"),document.querySelector("#hamburger").classList.toggle("is-active")}function toggleMenuAccordian(e){var t=e.target;if($(t).parent().hasClass("active"))return $(t).parent().removeClass("active"),void $(t).siblings().removeClass("accordian-open");$(t).parent(".menu-item-has-children").addClass("active").siblings().removeClass("active").find(".sub-menu--level-two").removeClass("accordian-open"),$(t).siblings().addClass("accordian-open")}function toggleChatWindow(e){e.preventDefault(),1!=window.fcWidget.isOpen()?window.fcWidget.open():window.fcWidget.close()}function updateHero(e,t){var r=document.querySelector(".hero--not-home");r.style.backgroundImage=e;var a=r.querySelector("h1");a.innerHTML=t,a.style.opacity=1}function fixHeader(){window.scrollY>siteHeaderOffset?(document.body.style.paddingTop=siteHeader.offsetHeight+"px",document.body.classList.add("site-header-fixed")):(document.body.style.paddingTop=0,document.body.classList.remove("site-header-fixed"))}function matchCheckoutInput(e,t){var r=e.id.split("-")[2].substring(4),a=document.querySelector("#v65-onepage-ship"+r);a&&(a.value=t)}function getRelatedProducts(){$("#v65-product-parent > tbody > tr:nth-child(2) > td:nth-child(2) > table > tbody > tr > td > table > tbody").append('<tr><td colspan="2"><div id="gfp-related-products"></div></tr></td>');for(var e=relatedProductsContainer.find(".v65-productDisplay"),t=e.find("tr:first-child .v65-productName"),r=e.find("tr:nth-child(2) .product_productprice"),a=e.find("tr:last-child .v65-productPhoto"),i=0;i<a.length;i++){var o=a[i].querySelector("img").src;o.match(/nophoto/)||(a[i].querySelector("img").src=o.substring(0,o.length-6)+"-2T"+o.substring(o.length-4))}relatedProductsContainer.remove();var n=[];for(i=0;i<t.length;i++)n.push({productTitle:t[i].querySelector("a").innerHTML.trim(),productLink:t[i].querySelector("a").href,productImg:a[i].querySelector("img").outerHTML,productPrice:r[i].textContent.trim()});$("#gfp-related-products").html("<h3>Alternatives to "+pageTitle+'</h3><ul class="cost-alternatives-list"></ul>');var s=$("#gfp-related-products .cost-alternatives-list");for(i=0;i<n.length;i++){var c='<li><a href="'+n[i].productLink+'"><div class="cost-alternatives-list--image">'+n[i].productImg+'</div><div class="cost-alternatives-list--content"><p><strong>'+n[i].productTitle+"</strong></p><p>"+n[i].productPrice+"</p></div></a></li>";s.append(c)}}function formatRelatedProducts(){var e=[],t=$("#related_products_content .v65-productName"),r=$("#related_products_content .v65-productAvailability .product_productprice"),a=$("#related_products_content .v65-productPhoto");$("#v65-product-related").before('<div class="slider--related-products"><div class="site-width"></div></div>'),$("#v65-product-related").remove();for(var i=0;i<t.length;i++)e.push({relatedProductTitle:t[i].innerText,relatedProductPrice:r[i].innerText,relatedProductImg:a[i].querySelector("img").src,relatedProductLink:a[i].querySelector("a").href});var o=$(".slider--related-products .site-width");for(i=0;i<e.length;i++)o.append('<div class="slide"><a href="'+e[i].relatedProductLink+'">'+e[i].relatedProductTitle+"</a></div>")}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdsb2JhbC5qcyJdLCJuYW1lcyI6WyIkIiwiZm9jdXMiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwiYWRkQ2xhc3MiLCJmaW5kIiwicGFnZVBhdGgiLCJsb2NhdGlvbiIsInBhdGhuYW1lIiwiaGVyb0ltZyIsImdldFJhbmRvbUludCIsImhlcm9UZXh0IiwiYnJlYWRjcnVtYnMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJicmVhZGNydW1iQXJyYXkiLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwidGV4dENvbnRlbnQiLCJzcGxpdCIsImxlbmd0aCIsIm1hdGNoIiwiZmlsdGVySXRlbXMiLCJxdWVyeSIsInNlYXJjaFN0cmluZ0FycmF5IiwiZmlsdGVyIiwiZWwiLCJ0b0xvd2VyQ2FzZSIsImluZGV4T2YiLCJzZWFyY2hTdHJpbmciLCJzZWFyY2giLCJzZWFyY2hTdHJpbmdUZXJtIiwidG9TdHJpbmciLCJqb2luIiwiaXRlbURlc2NyaXB0aW9uIiwiaXRlbURlc2NyaXB0aW9uQXJyYXkiLCJpbm5lckhUTUwiLCJlbXB0eUNhcnRSb3ciLCJjaGlsZHJlbiIsImZpcnN0Iiwic2libGluZ3MiLCJyZW1vdmUiLCJjb2xTcGFuIiwiYmlsbElucHV0cyIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiaW5jbHVkZXMiLCJ0YXJnZXQiLCJpZCIsInNlbGYiLCJtYXRjaENoZWNrb3V0SW5wdXQiLCJ2YWx1ZSIsInVwZGF0ZUhlcm8iLCJwYXJlbnRFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwic2l0ZUhlYWRlciIsInNpdGVIZWFkZXJPZmZzZXQiLCJvZmZzZXRUb3AiLCJmaXhIZWFkZXIiLCJjb250YWlucyIsInRvZ2dsZU1lbnUiLCJ0b2dnbGVNZW51QWNjb3JkaWFuIiwiaGFzaCIsInRvZ2dsZUNoYXRXaW5kb3ciLCJyZUNhbGNCdXR0b24iLCJzaG9wcGluZ0NhcnRGb3JtIiwicGFyZW50IiwiY2FydFJvd3MiLCJxdWVyeVNlbGVjdG9yQWxsIiwiY2xlYW5DYXJ0Um93cyIsImkiLCJyZW1vdmVMaW5rIiwicHJvZHVjdEltYWdlIiwicHJvZHVjdE5hbWUiLCJxdWFudGl0eUlucHV0IiwicHJvZHVjdFByaWNlIiwiaW5uZXJUZXh0Iiwic3VtUHJpY2UiLCJwdXNoIiwicHJlcGVuZCIsIm91dGVySFRNTCIsImNhcnRUYWJsZSIsImFwcGVuZCIsImNoZWNrb3V0Q29udGFpbmVyIiwiYmlsbGluZ0hlYWRlciIsImh0bWwiLCJiaWxsaW5nQ29udGVudCIsInNoaXBwaW5nSGVhZGVyIiwic2hpcHBpbmdDb250ZW50IiwiYWRkaXRpb25hbEluZm9IZWFkZXIiLCJhZGRpdGlvbmFsSW5mb0NvbnRlbnQiLCJzaGlwcGluZ0Nvc3RIZWFkZXIiLCJzaGlwcGluZ0Nvc3RDb250ZW50Iiwic2hpcHBpbmdUb3RhbHMiLCJhZnRlciIsInJlc3BDaGVja291dCIsImdsb2JhbF9DdXJyZW50X1Byb2R1Y3RDb2RlIiwicGFnZVRpdGxlIiwicHJvZHVjdERlc2NyaXB0aW9uV3JhcCIsImNzcyIsImF0dHIiLCJyZWxhdGVkUHJvZHVjdHNDb250YWluZXIiLCJuZXh0IiwiZ2V0UmVsYXRlZFByb2R1Y3RzIiwiZml0bWVudFN0cmluZyIsImZpdG1lbnRBcnJheSIsInNvcnQiLCJmaXRtZW50TGlzdCIsImZvcm1hdFJlbGF0ZWRQcm9kdWN0cyIsIm1pbiIsIm1heCIsIk1hdGgiLCJjZWlsIiwiZmxvb3IiLCJyYW5kb20iLCJib2R5IiwidG9nZ2xlIiwiaGFzQ2xhc3MiLCJyZW1vdmVDbGFzcyIsInByZXZlbnREZWZhdWx0IiwiZmNXaWRnZXQiLCJpc09wZW4iLCJvcGVuIiwiY2xvc2UiLCJoZXJvQ29udGFpbmVyIiwic3R5bGUiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJoZXJvSGVhZGluZyIsIm9wYWNpdHkiLCJzY3JvbGxZIiwicGFkZGluZ1RvcCIsIm9mZnNldEhlaWdodCIsImVsZW0iLCJ2YWwiLCJpbnB1dCIsInN1YnN0cmluZyIsInNoaXBFbGVtIiwicmVsYXRlZFByb2R1Y3RzIiwicmVsYXRlZFByb2R1Y3RUaXRsZSIsInJlbGF0ZWRQcm9kdWN0UHJpY2UiLCJyZWxhdGVkUHJvZHVjdEltZyIsImltYWdlUGF0aCIsInNyYyIsImNsZWFuQWx0ZXJuYXRpdmVQcm9kdWN0cyIsInByb2R1Y3RUaXRsZSIsInRyaW0iLCJwcm9kdWN0TGluayIsImhyZWYiLCJwcm9kdWN0SW1nIiwiY2xlYW5BbHRlcm5hdGl2ZVByb2R1Y3RzVGFibGUiLCJjbGVhblJlbGF0ZWRQcm9kdWN0cyIsInByb2R1Y3RUaXRsZXMiLCJiZWZvcmUiLCJyZWxhdGVkUHJvZHVjdExpbmsiLCJzbGlkZXJSZWxhdGVkUHJvZHVjdHMiXSwibWFwcGluZ3MiOiJBQUFBQSxFQUFFLCtCQUErQkMsUUFFN0JDLE9BQU9DLFdBQWEsTUFDcEJILEVBQUUsZ0VBQWdFSSxTQUFTLFVBQVVDLEtBQUssd0JBQXdCRCxTQUFTLGtCQUcvSCxJQUFJRSxTQUFXSixPQUFPSyxTQUFTQyxTQUUzQkMsUUFBVSx3REFBMERDLGFBQWEsRUFBRyxHQUFLLFFBQ3pGQyxTQUFXLG1CQUVYQyxZQUFjQyxTQUFTQyxjQUFjLDBCQUV6QyxHQUFJRixZQUFhLENBQ2IsSUFBSUcsZ0JBQWtCSCxZQUFZSSx1QkFBdUJDLFlBQVlDLE1BQU0sS0FDM0VQLFNBQVdJLGdCQUFnQkEsZ0JBQWdCSSxPQUFTLEdBbUJ4RCxHQWZJYixTQUFTYyxNQUFNLGNBQ2ZYLFFBQVUsNkRBSVZILFNBQVNjLE1BQU0sdUJBQ2ZYLFFBQVUsc0VBSVZILFNBQVNjLE1BQU0sV0FDZlgsUUFBVSwwREFJRyx1QkFBYkgsU0FBbUMsQ0FJbkMsU0FBU2UsWUFBWUMsR0FDbkIsT0FBT0Msa0JBQWtCQyxPQUFPLFNBQVNDLEdBQ3JDLE9BQU9BLEVBQUdDLGNBQWNDLFFBQVFMLEVBQU1JLGdCQUFrQixJQUw5REUsYUFBZTFCLE9BQU9LLFNBQVNzQixPQUMvQk4sa0JBQW9CSyxhQUFhVixNQUFNLEtBUXZDLElBQUlZLGlCQUFtQlQsWUFBWSxXQUFXVSxXQUFXYixNQUFNLEtBQUssR0FFcEVQLFNBQVcs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TCxHQUFHTSxVQUNyQ2dFLGtCQUFtQlEsRUFBVzlFLEdBQUd4RCxjQUFjLE9BQU9nSSxJQUN0RFcsbUJBQW9CTCxFQUFXOUUsR0FBR3hELGNBQWMsS0FBS3FJLE9BSTdELElBQUlPLEVBQXdCMUosRUFBRSx5Q0FFOUIsSUFBU3NFLEVBQUksRUFBR0EsRUFBSWdGLEVBQXFCbkksT0FBUW1ELElBQzdDb0YsRUFBc0J4RSxPQUFPLCtCQUFpQ29FLEVBQXFCaEYsR0FBR21GLG1CQUFxQixLQUFPSCxFQUFxQmhGLEdBQUdvRSxvQkFBc0IiLCJmaWxlIjoiZ2xvYmFsLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJCgnLnNlYXJjaC1iYXItY29udGFpbmVyIGlucHV0JykuZm9jdXMoKTtcblxuaWYgKHdpbmRvdy5pbm5lcldpZHRoID4gMTA4MCkge1xuICAgICQoJy5tZW51LWl0ZW0tLXRvcC1sZXZlbCAuc3ViLW1lbnUtLWxldmVsLW9uZSA+IGxpOm50aC1jaGlsZCgyKScpLmFkZENsYXNzKCdhY3RpdmUnKS5maW5kKCcuc3ViLW1lbnUtLWxldmVsLXR3bycpLmFkZENsYXNzKCdhY2NvcmRpYW4tb3BlbicpO1xufVxuXG52YXIgcGFnZVBhdGggPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWU7XG5cbnZhciBoZXJvSW1nID0gJ3VybCgvdi92c3BmaWxlcy90ZW1wbGF0ZXMvZ2ZwLXRlc3QvaW1nL2hlcm8tLWdlbmVyaWMtJyArIGdldFJhbmRvbUludCgxLCA1KSArICcuanBnKSc7XG52YXIgaGVyb1RleHQgPSAnR3JlZW4gRmFybSBQYXJ0cyc7XG5cbnZhciBicmVhZGNydW1icyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tYXRjaGluZ19yZXN1bHRzX3RleHQnKTtcblxuaWYgKGJyZWFkY3J1bWJzKSB7XG4gICAgdmFyIGJyZWFkY3J1bWJBcnJheSA9IGJyZWFkY3J1bWJzLnByZXZpb3VzRWxlbWVudFNpYmxpbmcudGV4dENvbnRlbnQuc3BsaXQoJz4nKTtcbiAgICBoZXJvVGV4dCA9IGJyZWFkY3J1bWJBcnJheVticmVhZGNydW1iQXJyYXkubGVuZ3RoIC0gMV07ICAgIFxufVxuXG5cbmlmIChwYWdlUGF0aC5tYXRjaCgvRmlsdGVycy9pKSkge1xuICAgIGhlcm9JbWcgPSAndXJsKC92L3ZzcGZpbGVzL3RlbXBsYXRlcy9nZnAtdGVzdC9pbWcvaGVyby0tZmlsdGVycy5qcGcpJztcbiAgICAvLyBoZXJvVGV4dCA9ICdPaWwgRmlsdGVycyc7XG59XG5cbmlmIChwYWdlUGF0aC5tYXRjaCgvTWFpbnRlbmFuY2UtS2l0cy9pKSkge1xuICAgIGhlcm9JbWcgPSAndXJsKC92L3ZzcGZpbGVzL3RlbXBsYXRlcy9nZnAtdGVzdC9pbWcvaGVyby0tbWFpbnRlbmFuY2Uta2l0cy5qcGcpJztcbiAgICAvLyBoZXJvVGV4dCA9ICdNYWludGVuYW5jZSBLaXRzJztcbn1cblxuaWYgKHBhZ2VQYXRoLm1hdGNoKC9Ub3lzL2kpKSB7XG4gICAgaGVyb0ltZyA9ICd1cmwoL3YvdnNwZmlsZXMvdGVtcGxhdGVzL2dmcC10ZXN0L2ltZy9oZXJvLS10b3lzLmpwZyknO1xuICAgIC8vIGhlcm9UZXh0ID0gJ1RveXMnO1xufVxuXG5pZiAocGFnZVBhdGggPT09ICcvc2VhcmNocmVzdWx0cy5hc3AnKSB7XG4gICAgc2VhcmNoU3RyaW5nID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaDtcbiAgICBzZWFyY2hTdHJpbmdBcnJheSA9IHNlYXJjaFN0cmluZy5zcGxpdCgnJicpO1xuICAgIFxuICAgIGZ1bmN0aW9uIGZpbHRlckl0ZW1zKHF1ZXJ5KSB7XG4gICAgICByZXR1cm4gc2VhcmNoU3RyaW5nQXJyYXkuZmlsdGVyKGZ1bmN0aW9uKGVsKSB7XG4gICAgICAgICAgcmV0dXJuIGVsLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihxdWVyeS50b0xvd2VyQ2FzZSgpKSA+IC0xO1xuICAgICAgfSlcbiAgICB9XG5cbiAgICB2YXIgc2VhcmNoU3RyaW5nVGVybSA9IGZpbHRlckl0ZW1zKCdzZWFyY2g9JykudG9TdHJpbmcoKS5zcGxpdCgnPScpWzFdO1xuICAgIHNlYXJjaFN0cmluZ1Rlcm0gPSBzZWFyY2hTdHJpbmdUZXJtLnNwbGl0KCcrJykuam9pbignICcpO1xuICAgIGhlcm9UZXh0ID0gJ1NlYXJjaCBmb3I6ICcgKyBzZWFyY2hTdHJpbmdUZXJtO1xufVxuXG5pZiAoKHBhZ2VQYXRoID09PSAnL1Nob3BwaW5nQ2FydC5hc3AnKSB8fCBwYWdlUGF0aCA9PT0gJy9zaG9wcGluZ2NhcnQuYXNwJykge1xuICAgIGhlcm9UZXh0ID0gJ1Nob3BwaW5nIENhcnQnO1xuICAgIHZhciBpdGVtRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdjY1LWNhcnQtaGVhZGVyLWl0ZW1kZXNjcmlwdGlvbiBmb250Jyk7XG4gICAgaWYgKGl0ZW1EZXNjcmlwdGlvbiAhPSBudWxsKSB7XG4gICAgICAgIHZhciBpdGVtRGVzY3JpcHRpb25BcnJheSA9IGl0ZW1EZXNjcmlwdGlvbi5pbm5lckhUTUwuc3BsaXQoJyZuYnNwOycpO1xuICAgICAgICBpdGVtRGVzY3JpcHRpb24uaW5uZXJIVE1MID0gaXRlbURlc2NyaXB0aW9uQXJyYXlbMF0gKyAnICcgKyBpdGVtRGVzY3JpcHRpb25BcnJheVsyXTtcbiAgICB9XG4gICAgdmFyIGVtcHR5Q2FydFJvdyA9ICQoJy52NjUtY2FydC1zaGlwcGluZy1kZXRhaWxzLXJvdycpLmNoaWxkcmVuKCkuZmlyc3QoKTtcbiAgICBpZiAoZW1wdHlDYXJ0Um93Lmxlbmd0aCA8IDApIHtcbiAgICAgICAgZW1wdHlDYXJ0Um93LnNpYmxpbmdzKCkucmVtb3ZlKCk7XG4gICAgICAgIGVtcHR5Q2FydFJvd1swXS5jb2xTcGFuID0gMTI7ICAgIFxuICAgIH1cbn1cblxuaWYgKHBhZ2VQYXRoID09PSAnL215YWNjb3VudC5hc3AnKSB7XG4gICAgaGVyb1RleHQgPSAnTXkgQWNjb3VudCBEZXRhaWxzJztcbn1cblxuaWYgKHBhZ2VQYXRoID09PSAnL2xvZ2luLmFzcCcpIHtcbiAgICBoZXJvVGV4dCA9ICdMb2dpbic7XG59XG5cbmlmIChwYWdlUGF0aCA9PT0gJy90ZXJtcy5hc3AnKSB7XG4gICAgaGVyb1RleHQgPSAnVGVybXMgYW5kIENvbmRpdGlvbnMnO1xufVxuXG5pZiAocGFnZVBhdGggPT09ICcvb25lLXBhZ2UtY2hlY2tvdXQuYXNwJykge1xuICAgIGhlcm9UZXh0ID0gJ0NoZWNrb3V0JztcblxuICAgIHZhciBiaWxsSW5wdXRzID0gW1xuICAgICAgICBcInY2NS1vbmVwYWdlLWJpbGxmaXJzdG5hbWVcIixcbiAgICAgICAgXCJ2NjUtb25lcGFnZS1iaWxsbGFzdG5hbWVcIixcbiAgICAgICAgXCJ2NjUtb25lcGFnZS1iaWxsY29tcGFueW5hbWVcIixcbiAgICAgICAgXCJ2NjUtb25lcGFnZS1iaWxsYWRkcjFcIixcbiAgICAgICAgXCJ2NjUtb25lcGFnZS1iaWxsYWRkcjJcIixcbiAgICAgICAgXCJ2NjUtb25lcGFnZS1iaWxsY2l0eVwiLFxuICAgICAgICBcInY2NS1vbmVwYWdlLWJpbGxwb3N0YWxjb2RlXCIsXG4gICAgICAgIFwidjY1LW9uZXBhZ2UtYmlsbHBob25lXCIsXG4gICAgICAgIFwidjY1LW9uZXBhZ2UtYmlsbGZheFwiLFxuICAgICAgICBcInY2NS1jYXJ0LWJpbGxlbWFpbFwiXG4gICAgXTtcblxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24oZSkge1xuICAgICAgICBpZiAoYmlsbElucHV0cy5pbmNsdWRlcyhlLnRhcmdldC5pZCkpIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gZS50YXJnZXQ7XG4gICAgICAgICAgICB2YXIgdmFsID0gc2VsZi52YWx1ZTtcbiAgICAgICAgICAgIG1hdGNoQ2hlY2tvdXRJbnB1dChzZWxmLCB2YWwpO1xuICAgICAgICB9IFxuICAgIH0pO1xuXG59XG5cbmlmIChwYWdlUGF0aCAhPSAnLycpIHtcbiAgICB1cGRhdGVIZXJvKGhlcm9JbWcsIGhlcm9UZXh0KTtcbn1cblxuXG5cblxuXG5pZiAoYnJlYWRjcnVtYnMpIHtcbiAgICBicmVhZGNydW1icy5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnYnJlYWRjcnVtYnMnKTtcbn1cblxudmFyIHNpdGVIZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2l0ZS1oZWFkZXInKTtcbnZhciBzaXRlSGVhZGVyT2Zmc2V0ID0gc2l0ZUhlYWRlci5vZmZzZXRUb3A7XG5cbmlmIChzaXRlSGVhZGVyKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIGZpeEhlYWRlcik7XG59XG5cblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cbiAgICBpZiAoKGUudGFyZ2V0LmlkID09PSAnaGFtYnVyZ2VyJykgfHwgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnaGFtYnVyZ2VyLWJveCcpKSB8fCAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdoYW1idXJnZXItaW5uZXInKSkpIHtcbiAgICAgICAgdG9nZ2xlTWVudSgpO1xuICAgIH1cblxuICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2FjY29yZGlhbi10b2dnbGUtLXNpdGUtaGVhZGVyJykpIHtcbiAgICAgICAgdG9nZ2xlTWVudUFjY29yZGlhbihlKTtcbiAgICB9XG5cbiAgICBpZiAoZS50YXJnZXQuaGFzaCA9PT0gJyNjaGF0Jykge1xuICAgICAgICB0b2dnbGVDaGF0V2luZG93KGUpO1xuICAgIH1cblxufSk7XG5cblxuXG5cbi8qXG49PT09PT09PT09PT09PT09PT09PT09PT09XG5SRVNQT05TSVZFIFNIT1BQSU5HIENBUlRcbj09PT09PT09PT09PT09PT09PT09PT09PT1cbiovXG5pZiAoKHBhZ2VQYXRoID09PSAnL1Nob3BwaW5nQ2FydC5hc3AnKSB8fCBwYWdlUGF0aCA9PT0gJy9zaG9wcGluZ2NhcnQuYXNwJykge1xuICAgIHZhciByZUNhbGNCdXR0b24gPSAkKCcjYnRuUmVjYWxjdWxhdGUnKTtcbiAgICAvLyBjb25zb2xlLmxvZyhyZUNhbGNCdXR0b24pO1xuICAgICQoJyN2NjUtY2FydC1zaGlwcGluZy1kZXRhaWxzLXdyYXBwZXInKS5yZW1vdmUoKTtcbiAgICB2YXIgc2hvcHBpbmdDYXJ0Rm9ybSA9ICQoJyN2NjUtY2FydC10YWJsZScpLnBhcmVudCgnZm9ybScpO1xuICAgIHZhciBjYXJ0Um93cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyN2NjUtY2FydC10YWJsZSAudjY1LWNhcnQtZGV0YWlscy1yb3cnKTtcbiAgICB2YXIgY2xlYW5DYXJ0Um93cyA9IFtdO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYXJ0Um93cy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgcmVtb3ZlTGluayA9IGNhcnRSb3dzW2ldLnF1ZXJ5U2VsZWN0b3IoJy52NjUtY2FydC1pdGVtLXJlbW92ZS1saW5rJyk7XG4gICAgICAgIHZhciBwcm9kdWN0SW1hZ2UgPSBjYXJ0Um93c1tpXS5xdWVyeVNlbGVjdG9yKCcudjY1LWNhcnQtZGV0YWlsLXByb2R1Y3RpbWFnZScpLmlubmVySFRNTDtcbiAgICAgICAgdmFyIHByb2R1Y3ROYW1lID0gY2FydFJvd3NbaV0ucXVlcnlTZWxlY3RvcignLnY2NS1jYXJ0LWRldGFpbHMtdGV4dCAuY2FydC1pdGVtLW5hbWUnKTtcbiAgICAgICAgdmFyIHF1YW50aXR5SW5wdXQgPSBjYXJ0Um93c1tpXS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lKj1cIlF1YW50aXR5XCJdJyk7XG4gICAgICAgIHZhciBwcm9kdWN0UHJpY2UgPSBjYXJ0Um93c1tpXS5xdWVyeVNlbGVjdG9yKCd0ZDpudGgtY2hpbGQoOSkgLmNhcnR0ZXh0JykuaW5uZXJUZXh0O1xuICAgICAgICB2YXIgc3VtUHJpY2UgPSBjYXJ0Um93c1tpXS5xdWVyeVNlbGVjdG9yKCd0ZDpudGgtY2hpbGQoMTEpIC5jYXJ0dGV4dCcpLmlubmVyVGV4dDtcbiAgICAgICAgY2xlYW5DYXJ0Um93cy5wdXNoKHtcbiAgICAgICAgICAgIHJlbW92ZUxpbms6IHJlbW92ZUxpbmssXG4gICAgICAgICAgICBwcm9kdWN0SW1hZ2U6IHByb2R1Y3RJbWFnZSxcbiAgICAgICAgICAgIHByb2R1Y3ROYW1lOiBwcm9kdWN0TmFtZSxcbiAgICAgICAgICAgIHF1YW50aXR5SW5wdXQ6IHF1YW50aXR5SW5wdXQsXG4gICAgICAgICAgICBwcm9kdWN0UHJpY2U6IHByb2R1Y3RQcmljZSxcbiAgICAgICAgICAgIHN1bVByaWNlOiBzdW1QcmljZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzaG9wcGluZ0NhcnRGb3JtLnByZXBlbmQoJzxkaXYgaWQ9XCJnZnAtcmVzcG9uc2l2ZS1jYXJ0XCI+PHRhYmxlPjx0aGVhZD48dHI+PHRoIGNsYXNzPVwiZ2ZwLXJlc3BvbnNpdmUtY2FydC0tcHJvZHVjdC1pbWFnZVwiPjwvdGg+PHRoIGNsYXNzPVwiZ2ZwLXJlc3BvbnNpdmUtY2FydC0tcHJvZHVjdC1kZXNjcmlwdGlvblwiPkl0ZW08L3RoPjx0aCBjbGFzcz1cImdmcC1yZXNwb25zaXZlLWNhcnQtLXVuaXQtcHJpY2VcIj5Vbml0IFByaWNlPC90aD48dGggY2xhc3M9XCJnZnAtcmVzcG9uc2l2ZS1jYXJ0LS1xdWFudGl0eVwiPlF1YW50aXR5PC90aD48dGggY2xhc3M9XCJnZnAtcmVzcG9uc2l2ZS1jYXJ0LS11bml0LXRvdGFsXCI+VG90YWw8L3RoPjx0aCBjbGFzcz1cImdmcC1yZXNwb25zaXZlLWNhcnQtLXJlbW92ZS1pdGVtXCI+PC90aD48L3RyPjwvdGhlYWQ+PHRib2R5PjwvdGJvZHk+PC90YWJsZT4nICsgcmVDYWxjQnV0dG9uWzBdLm91dGVySFRNTCArICc8L2Rpdj4nKTtcblxuICAgICQoJyN2NjUtY2FydC10YWJsZScpLnJlbW92ZSgpO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjbGVhbkNhcnRSb3dzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBjYXJ0VGFibGUgPSAkKCcjZ2ZwLXJlc3BvbnNpdmUtY2FydCB0Ym9keScpO1xuICAgICAgICBjYXJ0VGFibGUuYXBwZW5kKCc8dHI+PHRkIGNsYXNzPVwiZ2ZwLXJlc3BvbnNpdmUtY2FydC0tcHJvZHVjdC1pbWFnZVwiPicgKyBjbGVhbkNhcnRSb3dzW2ldLnByb2R1Y3RJbWFnZSArICc8L3RkPjx0ZCBjbGFzcz1cImdmcC1yZXNwb25zaXZlLWNhcnQtLXByb2R1Y3QtZGVzY3JpcHRpb25cIj4nICsgY2xlYW5DYXJ0Um93c1tpXS5wcm9kdWN0TmFtZS5pbm5lclRleHQgKyAnPC90ZD48dGQgY2xhc3M9XCJnZnAtcmVzcG9uc2l2ZS1jYXJ0LS11bml0LXByaWNlXCI+JyArIGNsZWFuQ2FydFJvd3NbaV0ucHJvZHVjdFByaWNlICsgJzwvdGQ+PHRkIGNsYXNzPVwiZ2ZwLXJlc3BvbnNpdmUtY2FydC0tcXVhbnRpdHlcIj4nICsgY2xlYW5DYXJ0Um93c1tpXS5xdWFudGl0eUlucHV0Lm91dGVySFRNTCArICc8L3RkPjx0ZCBjbGFzcz1cImdmcC1yZXNwb25zaXZlLWNhcnQtLXVuaXQtdG90YWxcIj4nICsgY2xlYW5DYXJ0Um93c1tpXS5zdW1QcmljZSArICc8L3RkPjx0ZCBjbGFzcz1cImdmcC1yZXNwb25zaXZlLWNhcnQtLXJlbW92ZS1pdGVtXCI+JyArIGNsZWFuQ2FydFJvd3NbaV0ucmVtb3ZlTGluay5vdXRlckhUTUwgKyAnPC90ZD48L3RyPicpO1xuICAgIH1cbn1cblxuXG5cblxuXG5cbi8qXG49PT09PT09PT09PT09PT09PT09PT09PT09XG5SRVNQT05TSVZFIENIRUNLT1VUXG49PT09PT09PT09PT09PT09PT09PT09PT09XG4qL1xudmFyIGNoZWNrb3V0Q29udGFpbmVyID0gJCgnI3Y2NS1vbmVwYWdlLURldGFpbCcpO1xudmFyIGJpbGxpbmdIZWFkZXIgPSAkKCcjYmlsbGluZy1oZWFkZXInKS5odG1sKCk7XG52YXIgYmlsbGluZ0NvbnRlbnQgPSAkKCcjdjY1LW9uZXBhZ2UtQmlsbGluZ1BhcmVudCcpLmh0bWwoKTtcbnZhciBzaGlwcGluZ0hlYWRlciA9ICQoJyNzaGlwcGluZy1oZWFkZXInKS5odG1sKCk7XG52YXIgc2hpcHBpbmdDb250ZW50ID0gJCgnI3Y2NS1vbmVwYWdlLVNoaXBwaW5nUGFyZW50JykuaHRtbCgpO1xudmFyIGFkZGl0aW9uYWxJbmZvSGVhZGVyID0gJCgnLnY2NS1vbmVwYWdlLWN1c3RvbS1oZWFkZXItcm93JykuaHRtbCgpO1xudmFyIGFkZGl0aW9uYWxJbmZvQ29udGVudCA9ICQoJy52NjUtb25lcGFnZS1jdXN0b20tZGV0YWlscy1yb3cnKS5odG1sKCk7XG52YXIgc2hpcHBpbmdDb3N0SGVhZGVyID0gJCgnI3Y2NS1vbmVwYWdlLVNoaXBwaW5nQ29zdEhlYWRlcicpLmh0bWwoKTtcbnZhciBzaGlwcGluZ0Nvc3RDb250ZW50ID0gJCgnI3Y2NS1vbmVwYWdlLVNoaXBwaW5nQ29zdFRvdGFscycpLmh0bWwoKTtcbnZhciBzaGlwcGluZ1RvdGFscyA9ICQoJyN2NjUtb25lcGFnZS1TaGlwcGluZ0Nvc3RQYXJlbnQnKS5wYXJlbnQoKS5odG1sKCk7XG5cblxuY2hlY2tvdXRDb250YWluZXIucmVtb3ZlKCk7XG5cblxuXG4kKCcjRm9ybWF0TGlzdG9mRXJyb3JzRGl2JykuYWZ0ZXIoJzxkaXYgaWQ9XCJnZnAtcmVzcG9uc2l2ZS1jaGVja291dFwiPjwvZGl2PicpO1xudmFyIHJlc3BDaGVja291dCA9ICQoJyNnZnAtcmVzcG9uc2l2ZS1jaGVja291dCcpO1xuXG5yZXNwQ2hlY2tvdXQuaHRtbCgnPGRpdiBjbGFzcz1cImdmcC1oYWxmXCI+PGRpdj4nICsgYmlsbGluZ0hlYWRlciArIGJpbGxpbmdDb250ZW50ICsgJzwvZGl2PicgKyAnPGRpdj4nICsgc2hpcHBpbmdIZWFkZXIgKyBzaGlwcGluZ0NvbnRlbnQgKyAnPC9kaXY+PC9kaXY+Jyk7XG5yZXNwQ2hlY2tvdXQuYXBwZW5kKCc8dGFibGUgaWQ9XCJ2NjUtb25lcGFnZS1hZGRpdGlvbmFsLWluZm9cIj48dGJvZHk+PHRyPicgKyBhZGRpdGlvbmFsSW5mb0hlYWRlciArICc8L3RyPjx0cj4nICsgYWRkaXRpb25hbEluZm9Db250ZW50ICsgJzwvdHI+PC90Ym9keT48L3RhYmxlPicpO1xucmVzcENoZWNrb3V0LmFwcGVuZChzaGlwcGluZ1RvdGFscyk7XG5cblxuXG4vKlxuPT09PT09PT09PT09PT09PT09PT09PT09PVxuS0lMTFNIRUVUXG49PT09PT09PT09PT09PT09PT09PT09PT09XG4qL1xuJCgnaW1nW3NyYz1cIi92L3ZzcGZpbGVzL3RlbXBsYXRlcy9nZnAtdGVzdC9pbWFnZXMvY2xlYXIxeDEuZ2lmXCJdJykucmVtb3ZlKCk7XG4kKCcuY29sb3JzX3ByaWNlYm94IGltZ1tzcmM9XCIvdi92c3BmaWxlcy90ZW1wbGF0ZXMvZ2ZwLXRlc3QvaW1hZ2VzL1BCb3hfQm9yZGVyX0xlZnRfVG9wLmdpZlwiXScpLnBhcmVudCgndHInKS5yZW1vdmUoKTtcbmlmICgkKCcjdjY1LW9uZXBhZ2UtYnJlYWRjcnVtYicpKSB7XG4gICAgJCgnI3Y2NS1vbmVwYWdlLWJyZWFkY3J1bWInKS5yZW1vdmUoKTtcbn1cbiQoJyN2NjUtb25lcGFnZS1Db3B5QmlsbGluZ1RvU2hpcHBpbmdMaW5rJykucmVtb3ZlKCk7XG5cblxuXG4vKlxuPT09PT09PT09PT09PT09PT09PT09PT09PVxuU0lOR0xFIFBST0RVQ1Rcbj09PT09PT09PT09PT09PT09PT09PT09PT1cbiovXG5pZiAod2luZG93Lmdsb2JhbF9DdXJyZW50X1Byb2R1Y3RDb2RlKSB7XG4gICAgdmFyIHBhZ2VUaXRsZSA9ICQoJy52cC1wcm9kdWN0LXRpdGxlJylbMF0uaW5uZXJUZXh0O1xuXG4gICAgdmFyIHByb2R1Y3REZXNjcmlwdGlvbldyYXAgPSAkKCcjdjY1LXByb2R1Y3RkZXRhaWwtYWN0aW9uLXdyYXBwZXInKTtcbiAgICBwcm9kdWN0RGVzY3JpcHRpb25XcmFwLmNzcyhcImRpc3BsYXlcIiwgXCJibG9ja1wiKS5hdHRyKCdhbGlnbicsICdsZWZ0Jyk7XG4gICAgcHJvZHVjdERlc2NyaXB0aW9uV3JhcC5zaWJsaW5ncygpLmNzcyhcImRpc3BsYXlcIiwgXCJibG9ja1wiKTtcblxuICAgIHVwZGF0ZUhlcm8oaGVyb0ltZywgcGFnZVRpdGxlKTtcblxuICAgIC8vIEdFVCBUSEUgQ09OVEFJTkVSIEFORCBEUk9QIElOIE5FVyBDT05UQUlORVIgQkVGT1JFIFRIRSBFTEVNRU5UIFRPIEJFIERFTEVURURcbiAgICB2YXIgcmVsYXRlZFByb2R1Y3RzQ29udGFpbmVyID0gJCgnI3Y2NS1wcm9kdWN0LXBhcmVudCcpLm5leHQoKS5maW5kKCcuY29sb3JzX2xpbmVzX2xpZ2h0JykuZmlyc3QoKTtcbiAgICBpZiAocmVsYXRlZFByb2R1Y3RzQ29udGFpbmVyWzBdLmlkICE9PSAndjY1LXByb2R1Y3QtcmVsYXRlZCcpIHtcbiAgICAgICAgZ2V0UmVsYXRlZFByb2R1Y3RzKCk7XG4gICAgfVxuICAgIFxuXG4gICAgJCgnc3BhbltpdGVtcHJvcD1cImRlc2NyaXB0aW9uXCJdJykucHJlcGVuZCgnPHAgY2xhc3M9XCJoMVwiPicgKyBwYWdlVGl0bGUgKyAnPC9wPicpO1xuXG5cbiAgICB2YXIgZml0bWVudFN0cmluZyA9ICQoJyNQcm9kdWN0RGV0YWlsX1Byb2R1Y3REZXRhaWxzX2RpdjIgbGknKTtcbiAgICBpZiAoZml0bWVudFN0cmluZy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHZhciBmaXRtZW50QXJyYXkgPSBmaXRtZW50U3RyaW5nWzBdLmlubmVyVGV4dC5zcGxpdCgnfCcpLnNvcnQoKTtcbiAgICAgICAgJCgnI1Byb2R1Y3REZXRhaWxfUHJvZHVjdERldGFpbHNfZGl2MicpLnJlbW92ZSgpO1xuICAgICAgICAkKCcjdjY1LXByb2R1Y3QtcGFyZW50ID4gdGJvZHkgPiB0cjpudGgtY2hpbGQoMikgPiB0ZDpudGgtY2hpbGQoMikgPiB0YWJsZSA+IHRib2R5ID4gdHIgPiB0ZCA+IHRhYmxlID4gdGJvZHknKS5hcHBlbmQoJzx0cj48dGQgY29sc3Bhbj1cIjJcIj48aDMgY2xhc3M9XCJtYXItdC0tbW9yZVwiPicgKyBwYWdlVGl0bGUgKyAnIGZpdHMgdGhlIGZvbGxvd2luZyBtb2RlbHM6PC9oMz48aHI+PHVsIGlkPVwiZ2ZwLWZpdG1lbnRcIj48L3VsPjwvdHI+PC90ZD4nKTtcbiAgICAgICAgdmFyIGZpdG1lbnRMaXN0ID0gJCgnI2dmcC1maXRtZW50Jyk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZml0bWVudEFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBmaXRtZW50TGlzdC5hcHBlbmQoJzxsaT4nICsgZml0bWVudEFycmF5W2ldICsgJzwvbGk+Jyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoJCgnI3JlbGF0ZWRfcHJvZHVjdHNfY29udGVudCcpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZm9ybWF0UmVsYXRlZFByb2R1Y3RzKCk7XG4gICAgfVxuXG5cblxufVxuXG5cblxuXG5mdW5jdGlvbiBnZXRSYW5kb21JbnQobWluLCBtYXgpIHtcbiAgbWluID0gTWF0aC5jZWlsKG1pbik7XG4gIG1heCA9IE1hdGguZmxvb3IobWF4KTtcbiAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSkgKyBtaW47IC8vVGhlIG1heGltdW0gaXMgaW5jbHVzaXZlIGFuZCB0aGUgbWluaW11bSBpcyBpbmNsdXNpdmUgXG59XG5cbmZ1bmN0aW9uIHRvZ2dsZU1lbnUoKSB7XG4gICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QudG9nZ2xlKCdtZW51LW9wZW4nKTtcbiAgICB2YXIgbWVudUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNoYW1idXJnZXInKTtcbiAgICBtZW51QnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ2lzLWFjdGl2ZScpO1xufVxuXG5mdW5jdGlvbiB0b2dnbGVNZW51QWNjb3JkaWFuKGUpIHtcbiAgICB2YXIgc2VsZiA9IGUudGFyZ2V0O1xuICAgIGlmICgkKHNlbGYpLnBhcmVudCgpLmhhc0NsYXNzKCdhY3RpdmUnKSkge1xuICAgICAgICAkKHNlbGYpLnBhcmVudCgpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgJChzZWxmKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKCdhY2NvcmRpYW4tb3BlbicpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgICQoc2VsZikucGFyZW50KCcubWVudS1pdGVtLWhhcy1jaGlsZHJlbicpLmFkZENsYXNzKCdhY3RpdmUnKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKS5maW5kKCcuc3ViLW1lbnUtLWxldmVsLXR3bycpLnJlbW92ZUNsYXNzKCdhY2NvcmRpYW4tb3BlbicpO1xuICAgICQoc2VsZikuc2libGluZ3MoKS5hZGRDbGFzcygnYWNjb3JkaWFuLW9wZW4nKTtcbn1cblxuZnVuY3Rpb24gdG9nZ2xlQ2hhdFdpbmRvdyhlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGlmICh3aW5kb3cuZmNXaWRnZXQuaXNPcGVuKCkgIT0gdHJ1ZSkge1xuICAgICAgICB3aW5kb3cuZmNXaWRnZXQub3BlbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHdpbmRvdy5mY1dpZGdldC5jbG9zZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gdXBkYXRlSGVybyhoZXJvSW1nLCBoZXJvVGV4dCkge1xuICAgIHZhciBoZXJvQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlcm8tLW5vdC1ob21lJyk7XG4gICAgaGVyb0NvbnRhaW5lci5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBoZXJvSW1nO1xuICAgIHZhciBoZXJvSGVhZGluZyA9IGhlcm9Db250YWluZXIucXVlcnlTZWxlY3RvcignaDEnKTtcbiAgICBoZXJvSGVhZGluZy5pbm5lckhUTUwgPSBoZXJvVGV4dDtcbiAgICBoZXJvSGVhZGluZy5zdHlsZS5vcGFjaXR5ID0gMTtcbn1cblxuZnVuY3Rpb24gZml4SGVhZGVyKCkge1xuICAgIGlmICh3aW5kb3cuc2Nyb2xsWSA+IHNpdGVIZWFkZXJPZmZzZXQpIHtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5wYWRkaW5nVG9wID0gc2l0ZUhlYWRlci5vZmZzZXRIZWlnaHQgKyAncHgnO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ3NpdGUtaGVhZGVyLWZpeGVkJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5wYWRkaW5nVG9wID0gMDtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdzaXRlLWhlYWRlci1maXhlZCcpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gbWF0Y2hDaGVja291dElucHV0KGVsZW0sIHZhbCkge1xuICAgIHZhciBpbnB1dCA9IGVsZW0uaWQuc3BsaXQoJy0nKVsyXS5zdWJzdHJpbmcoNCk7XG4gICAgdmFyIHNoaXBFbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Y2NS1vbmVwYWdlLXNoaXAnICsgaW5wdXQpO1xuICAgIGlmICghc2hpcEVsZW0pIHsgcmV0dXJuOyB9XG4gICAgc2hpcEVsZW0udmFsdWUgPSB2YWw7XG59XG5cbmZ1bmN0aW9uIGdldFJlbGF0ZWRQcm9kdWN0cygpIHtcbiAgICAkKCcjdjY1LXByb2R1Y3QtcGFyZW50ID4gdGJvZHkgPiB0cjpudGgtY2hpbGQoMikgPiB0ZDpudGgtY2hpbGQoMikgPiB0YWJsZSA+IHRib2R5ID4gdHIgPiB0ZCA+IHRhYmxlID4gdGJvZHknKS5hcHBlbmQoJzx0cj48dGQgY29sc3Bhbj1cIjJcIj48ZGl2IGlkPVwiZ2ZwLXJlbGF0ZWQtcHJvZHVjdHNcIj48L2Rpdj48L3RyPjwvdGQ+Jyk7XG5cbiAgICAvLyBHRVQgQUxMIFRIRSBEQVRBXG4gICAgdmFyIHJlbGF0ZWRQcm9kdWN0cyA9IHJlbGF0ZWRQcm9kdWN0c0NvbnRhaW5lci5maW5kKCcudjY1LXByb2R1Y3REaXNwbGF5Jyk7XG4gICAgdmFyIHJlbGF0ZWRQcm9kdWN0VGl0bGUgPSByZWxhdGVkUHJvZHVjdHMuZmluZCgndHI6Zmlyc3QtY2hpbGQgLnY2NS1wcm9kdWN0TmFtZScpO1xuXG4gICAgdmFyIHJlbGF0ZWRQcm9kdWN0UHJpY2UgPSByZWxhdGVkUHJvZHVjdHMuZmluZCgndHI6bnRoLWNoaWxkKDIpIC5wcm9kdWN0X3Byb2R1Y3RwcmljZScpO1xuXG4gICAgLy8gQ0xFQU4gVEhFIElNQUdFIFBBVEggVE8gR0VUIEJFVFRFUiBSRVNcbiAgICB2YXIgcmVsYXRlZFByb2R1Y3RJbWcgPSByZWxhdGVkUHJvZHVjdHMuZmluZCgndHI6bGFzdC1jaGlsZCAudjY1LXByb2R1Y3RQaG90bycpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVsYXRlZFByb2R1Y3RJbWcubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGltYWdlUGF0aCA9IHJlbGF0ZWRQcm9kdWN0SW1nW2ldLnF1ZXJ5U2VsZWN0b3IoJ2ltZycpLnNyYztcbiAgICAgICAgaWYgKCFpbWFnZVBhdGgubWF0Y2goL25vcGhvdG8vKSkge1xuICAgICAgICAgICAgcmVsYXRlZFByb2R1Y3RJbWdbaV0ucXVlcnlTZWxlY3RvcignaW1nJykuc3JjID0gaW1hZ2VQYXRoLnN1YnN0cmluZygwLCBpbWFnZVBhdGgubGVuZ3RoIC0gNikgKyAnLTJUJyArIGltYWdlUGF0aC5zdWJzdHJpbmcoaW1hZ2VQYXRoLmxlbmd0aCAtIDQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gV0lQRSBUSEUgT0xEIExJU1RcbiAgICByZWxhdGVkUHJvZHVjdHNDb250YWluZXIucmVtb3ZlKCk7XG4gICAgXG4gICAgLy8gQ1JFQVRFIFJFTEFURUQgUFJPRFVDVCBBUlJBWVxuICAgIHZhciBjbGVhbkFsdGVybmF0aXZlUHJvZHVjdHMgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlbGF0ZWRQcm9kdWN0VGl0bGUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY2xlYW5BbHRlcm5hdGl2ZVByb2R1Y3RzLnB1c2goe1xuICAgICAgICAgICAgcHJvZHVjdFRpdGxlOiByZWxhdGVkUHJvZHVjdFRpdGxlW2ldLnF1ZXJ5U2VsZWN0b3IoJ2EnKS5pbm5lckhUTUwudHJpbSgpLFxuICAgICAgICAgICAgcHJvZHVjdExpbms6IHJlbGF0ZWRQcm9kdWN0VGl0bGVbaV0ucXVlcnlTZWxlY3RvcignYScpLmhyZWYsXG4gICAgICAgICAgICBwcm9kdWN0SW1nOiByZWxhdGVkUHJvZHVjdEltZ1tpXS5xdWVyeVNlbGVjdG9yKCdpbWcnKS5vdXRlckhUTUwsXG4gICAgICAgICAgICBwcm9kdWN0UHJpY2U6IHJlbGF0ZWRQcm9kdWN0UHJpY2VbaV0udGV4dENvbnRlbnQudHJpbSgpXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgICQoJyNnZnAtcmVsYXRlZC1wcm9kdWN0cycpLmh0bWwoJzxoMz5BbHRlcm5hdGl2ZXMgdG8gJyArIHBhZ2VUaXRsZSArICc8L2gzPjx1bCBjbGFzcz1cImNvc3QtYWx0ZXJuYXRpdmVzLWxpc3RcIj48L3VsPicpO1xuXG5cbiAgICB2YXIgY2xlYW5BbHRlcm5hdGl2ZVByb2R1Y3RzVGFibGUgPSAkKCcjZ2ZwLXJlbGF0ZWQtcHJvZHVjdHMgLmNvc3QtYWx0ZXJuYXRpdmVzLWxpc3QnKTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2xlYW5BbHRlcm5hdGl2ZVByb2R1Y3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBodG1sID0gJzxsaT48YSBocmVmPVwiJyArIGNsZWFuQWx0ZXJuYXRpdmVQcm9kdWN0c1tpXS5wcm9kdWN0TGluayArICdcIj48ZGl2IGNsYXNzPVwiY29zdC1hbHRlcm5hdGl2ZXMtbGlzdC0taW1hZ2VcIj4nICsgY2xlYW5BbHRlcm5hdGl2ZVByb2R1Y3RzW2ldLnByb2R1Y3RJbWcgKyAnPC9kaXY+PGRpdiBjbGFzcz1cImNvc3QtYWx0ZXJuYXRpdmVzLWxpc3QtLWNvbnRlbnRcIj48cD48c3Ryb25nPicgKyBjbGVhbkFsdGVybmF0aXZlUHJvZHVjdHNbaV0ucHJvZHVjdFRpdGxlICsgJzwvc3Ryb25nPjwvcD48cD4nICsgY2xlYW5BbHRlcm5hdGl2ZVByb2R1Y3RzW2ldLnByb2R1Y3RQcmljZSArICc8L3A+PC9kaXY+PC9hPjwvbGk+JztcbiAgICAgICAgY2xlYW5BbHRlcm5hdGl2ZVByb2R1Y3RzVGFibGUuYXBwZW5kKGh0bWwpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZm9ybWF0UmVsYXRlZFByb2R1Y3RzKCkge1xuICAgIHZhciBjbGVhblJlbGF0ZWRQcm9kdWN0cyA9IFtdOztcbiAgICB2YXIgcHJvZHVjdFRpdGxlcyA9ICQoJyNyZWxhdGVkX3Byb2R1Y3RzX2NvbnRlbnQgLnY2NS1wcm9kdWN0TmFtZScpO1xuICAgIHZhciBwcm9kdWN0UHJpY2UgPSAkKCcjcmVsYXRlZF9wcm9kdWN0c19jb250ZW50IC52NjUtcHJvZHVjdEF2YWlsYWJpbGl0eSAucHJvZHVjdF9wcm9kdWN0cHJpY2UnKTtcbiAgICB2YXIgcHJvZHVjdEltZyA9ICQoJyNyZWxhdGVkX3Byb2R1Y3RzX2NvbnRlbnQgLnY2NS1wcm9kdWN0UGhvdG8nKTtcbiAgICBcbiAgICAkKCcjdjY1LXByb2R1Y3QtcmVsYXRlZCcpLmJlZm9yZSgnPGRpdiBjbGFzcz1cInNsaWRlci0tcmVsYXRlZC1wcm9kdWN0c1wiPjxkaXYgY2xhc3M9XCJzaXRlLXdpZHRoXCI+PC9kaXY+PC9kaXY+Jyk7XG4gICAgJCgnI3Y2NS1wcm9kdWN0LXJlbGF0ZWQnKS5yZW1vdmUoKTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvZHVjdFRpdGxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjbGVhblJlbGF0ZWRQcm9kdWN0cy5wdXNoKHtcbiAgICAgICAgICAgIHJlbGF0ZWRQcm9kdWN0VGl0bGU6IHByb2R1Y3RUaXRsZXNbaV0uaW5uZXJUZXh0LFxuICAgICAgICAgICAgcmVsYXRlZFByb2R1Y3RQcmljZTogcHJvZHVjdFByaWNlW2ldLmlubmVyVGV4dCxcbiAgICAgICAgICAgIHJlbGF0ZWRQcm9kdWN0SW1nOiBwcm9kdWN0SW1nW2ldLnF1ZXJ5U2VsZWN0b3IoJ2ltZycpLnNyYyxcbiAgICAgICAgICAgIHJlbGF0ZWRQcm9kdWN0TGluazogcHJvZHVjdEltZ1tpXS5xdWVyeVNlbGVjdG9yKCdhJykuaHJlZlxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICB2YXIgc2xpZGVyUmVsYXRlZFByb2R1Y3RzID0gJCgnLnNsaWRlci0tcmVsYXRlZC1wcm9kdWN0cyAuc2l0ZS13aWR0aCcpO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjbGVhblJlbGF0ZWRQcm9kdWN0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBzbGlkZXJSZWxhdGVkUHJvZHVjdHMuYXBwZW5kKCc8ZGl2IGNsYXNzPVwic2xpZGVcIj48YSBocmVmPVwiJyArIGNsZWFuUmVsYXRlZFByb2R1Y3RzW2ldLnJlbGF0ZWRQcm9kdWN0TGluayArICdcIj4nICsgY2xlYW5SZWxhdGVkUHJvZHVjdHNbaV0ucmVsYXRlZFByb2R1Y3RUaXRsZSArICc8L2E+PC9kaXY+Jyk7XG4gICAgfVxuXG59Il19
